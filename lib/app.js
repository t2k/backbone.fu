// Generated by CoffeeScript 1.6.3
(function() {
  var app, express, http, util;

  http = require("http");

  express = require("express");

  util = require('util');

  app = express();

  app.use(express["static"]("./public"));

  app.use(app.router);

  app.set('view engine', 'jade');

  app.set('views', './views');

  app.use(express.responseTime());

  app.get("/", function(req, res) {
    return res.render('index');
  });

  app.get("/upload", function(req, res) {
    return res.send("<h1>Upload!</h1>");
  });

  app.post("/upload", function(req, res) {
    var form, multiparty;
    multiparty = require('multiparty');
    form = new multiparty.Form({
      autoFiles: true,
      uploadDir: "./tempUploads"
    });
    return form.parse(req, function(err, fields, files) {
      if (err) {
        res.writeHead(500, {
          "content-type": "text/plain"
        });
        res.send("ERROR: uploading\n\n");
      }
      console.log("upload handled", fields, files);
      return res.json(util.inspect({
        message: "upload complete",
        fields: fields,
        files: files
      }));
    });
  });

  http.createServer(app).listen(process.env.PORT, function() {
    return console.log("Started: FU Express server listening on port# " + process.env.PORT);
  });

}).call(this);
